---
title: QQ 机器人
description: 通过 QQ 群聊/私聊与 Agent 对话，并接收审批提示与任务结果
---

# QQ 机器人（QQBot）集成

使用 QQ 官方机器人（QQBot）把 ShipMyAgent 接入到 QQ：支持 **群聊 @ 机器人** 与 **C2C 私聊** 两种场景。

## 配置步骤

### 1）创建 QQBot 应用并获取凭证

1. 前往 QQBot 平台创建机器人应用（QQ 开放平台 / QQBot 控制台）
2. 在应用信息中获取 **App ID**、**App Secret**
3. 确认机器人接入方式为 **WebSocket**，并开启群聊 / C2C 相关事件（用于接收消息）

### 2）写入项目配置

把凭证放到项目根目录的 `.env`（与 `ship.json` 同目录）：

```bash
QQ_APP_ID=your_app_id
QQ_APP_SECRET=your_app_secret
# 可选：使用沙箱环境
# QQ_SANDBOX=true
```

在 `ship.json` 启用 QQ 集成：

```json
{
  "integrations": {
    "qq": {
      "enabled": true,
      "appId": "${QQ_APP_ID}",
      "appSecret": "${QQ_APP_SECRET}",
      "sandbox": false
    }
  }
}
```

### 3）启动 ShipMyAgent

```bash
shipmyagent start
```

启动成功时，你会在日志中看到类似输出：

- `QQ integration enabled`
- `🤖 正在启动 QQ 机器人...`
- `WebSocket 连接已建立`
- `QQ Bot 已就绪`

## 使用方式

### C2C 私聊

直接给机器人发送消息即可开始对话。

### 群聊

把机器人添加到群里，然后通过 **@机器人** 的方式对话（例如：`@你的机器人 帮我总结一下今天的进度`）。

## 常见问题排查

- **启动后完全没反应**：先看终端输出；停止进程（`Ctrl+C`）后可在 `.ship/logs/` 下查看当天的日志文件。
- **群里收不到消息**：确认你是在群里 `@机器人`；并检查 QQBot 控制台中是否已开启群聊相关事件/权限。
- **App Secret 配错/权限不足**：日志里通常会出现获取 `access_token` 或 WebSocket 鉴权失败的错误信息；确认 `QQ_APP_ID` / `QQ_APP_SECRET` 与沙箱开关匹配。
- **想确认 QQ 实际发了哪些字段（尤其是 username/nickname）**：开启原始事件抓取后查看落盘的 JSON 快照：
  - 启用抓取：`SHIP_QQ_CAPTURE_EVENTS=dispatch`（只抓取业务事件）或 `SHIP_QQ_CAPTURE_EVENTS=all`（包含心跳/握手等）
  - 可选自定义目录：`SHIP_QQ_CAPTURE_DIR=...`
  - 默认目录：`<projectRoot>/.ship/.debug/qq-events/`
